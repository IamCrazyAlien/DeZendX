/*
///////////////////////////////////////////////////////////////////////////////
//
//  FileName    :   Patch.h
//  Version     :   1.0
//  Creator     :   RM
//  Create Date :   2006-01-01
//  Comment     :
//
///////////////////////////////////////////////////////////////////////////////
*/

#ifndef __PATCH_H__
#define __PATCH_H__

#ifdef __cplusplus
extern "C"
{
#endif

/*
///////////////////////////////////////////////////////////////////////////////
// D E F I N E S
///////////////////////////////////////////////////////////////////////////////
*/

/*
///////////////////////////////////////////////////////////////////////////////
// S T R U C T U R E S
///////////////////////////////////////////////////////////////////////////////
*/
typedef void ( *PATCH_FUNCTION )( ULONG Index, PVOID PatchAddress, PVOID PatchData, ULONG PatchDataSize, PVOID Context );

typedef struct _PATCH_ARRAY {
    PVOID Data;
    ULONG DataSize;
    PVOID PatchAddress;
    ULONG PatchOffset;
    PVOID PatchData;
    ULONG PatchDataSize;
} PATCH_ARRAY, PPATCH_ARRAY;

/*
///////////////////////////////////////////////////////////////////////////////
// G L O B A L S
///////////////////////////////////////////////////////////////////////////////
*/

/*
///////////////////////////////////////////////////////////////////////////////
// F U N C T I O N S
///////////////////////////////////////////////////////////////////////////////
*/
ULONG PatchMemory(
    PATCH_FUNCTION PatchFunction,
    PVOID Context,
    UCHAR *Address,
    ULONG Size,
    PATCH_ARRAY *PatchArray,
    ULONG PatchArrayCount,
    ULONG *PatchOffsetArray[],
    ULONG PatchOffsetArrayCount
    );

ULONG PatchFile(
    PATCH_FUNCTION PatchFunction,
    PVOID Context,
    LPCTSTR FileName,
    PATCH_ARRAY *PatchArray,
    ULONG PatchArrayCount,
    ULONG *PatchOffsetArray[],
    ULONG PatchOffsetArrayCount
    );

#ifdef __cplusplus
}
#endif
/*
///////////////////////////////////////////////////////////////////////////////
// E N D  O F  F I L E
///////////////////////////////////////////////////////////////////////////////
*/
#endif /* __PATCH_H__ */